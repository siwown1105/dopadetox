<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="manifest" href="manifest.json">
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log('âœ… ì„œë¹„ìŠ¤ì›Œì»¤ ë“±ë¡ë¨'));
  }
</script>

 <!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ë„íŒŒë¯¼ ë””í†¡ìŠ¤ ìº˜ë¦°ë” íŠ¸ë˜ì»¤</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
<style>
  body { font-family: 'Pretendard', sans-serif; }
  .checklist input:checked + span { text-decoration: line-through; color: gray; }
  .calendar-day {
    cursor: pointer;
    padding: 8px;
    border-radius: 4px;
    text-align: center;
    user-select: none;
  }
  .calendar-day.selected {
    background-color: #3b82f6;
    color: white;
    font-weight: bold;
  }
  .calendar-day:hover {
    background-color: #93c5fd;
  }
  #weeklySummary { display: none; }
  #motivationMsg {
    background-color: #e0f2fe;
    border-left: 4px solid #3b82f6;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 4px;
    font-weight: 600;
    font-size: 1.1rem;
    color: #0369a1;
  }
</style>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col items-center p-4">

<h1 class="text-3xl font-bold mb-6">ğŸ§  ë„íŒŒë¯¼ ë””í†¡ìŠ¤ ìº˜ë¦°ë” íŠ¸ë˜ì»¤</h1>

<section class="mb-6 w-full max-w-xl bg-white p-4 rounded shadow">
  <div class="flex justify-between items-center mb-3">
    <button id="prevMonth" class="px-3 py-1 bg-blue-500 text-white rounded">ì´ì „</button>
    <h2 id="monthYear" class="text-xl font-semibold"></h2>
    <button id="nextMonth" class="px-3 py-1 bg-blue-500 text-white rounded">ë‹¤ìŒ</button>
  </div>
  <div class="grid grid-cols-7 gap-1 text-center font-semibold mb-1">
    <div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>
  </div>
  <div id="calendar" class="grid grid-cols-7 gap-1"></div>
</section>

<section class="mb-4 w-full max-w-xl bg-white p-4 rounded shadow">
  <div id="motivationMsg">ì˜¤ëŠ˜ë„ ì˜í•˜ê³  ìˆì–´ìš”! í¬ê¸°í•˜ì§€ ë§ê³  ê³„ì† ë‚˜ì•„ê°€ì„¸ìš”! ğŸ’ª</div>
</section>

<section class="mb-8 w-full max-w-xl bg-white p-4 rounded shadow">
  <h3 class="text-xl font-semibold mb-3">ğŸ“… ì„ íƒí•œ ë‚ ì§œ: <span id="selectedDateStr"></span></h3>
  
  <div class="mb-4">
    <h4 class="font-semibold mb-2">âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸</h4>
    <div id="checklist" class="space-y-2 checklist"></div>
    <div class="flex gap-2 mt-2">
      <input type="text" id="newItemInput" placeholder="ìƒˆ í•­ëª© ì¶”ê°€..." class="border p-2 rounded flex-1" />
      <button id="addItemBtn" class="bg-green-500 text-white px-4 py-2 rounded">ì¶”ê°€</button>
    </div>
  </div>

  <div>
    <h4 class="font-semibold mb-2">ğŸ“ ì˜¤ëŠ˜ì˜ ì†Œê°</h4>
    <textarea id="diaryInput" rows="5" placeholder="ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ëŒì•„ë³´ë©° ëŠë‚€ ì ì„ ì ì–´ë³´ì„¸ìš”..." class="w-full border p-3 rounded"></textarea>
    <button id="saveDiaryBtn" class="bg-blue-500 text-white px-4 py-2 rounded mt-2">ì €ì¥í•˜ê¸°</button>
  </div>
</section>

<section class="mb-8 w-full max-w-xl bg-white p-4 rounded shadow">
  <button id="toggleWeeklySummary" class="bg-purple-600 text-white px-4 py-2 rounded mb-3">ì£¼ê°„ ì†Œê° ìš”ì•½ ë³´ê¸°</button>
  <div id="weeklySummary" class="space-y-4 max-h-96 overflow-y-auto"></div>
</section>

<script>
  // ë‚ ì§œ í¬ë§· (YYYY-MM-DD)
  function formatDateKey(date) {
    const tzoffset = date.getTimezoneOffset() * 60000;
    return new Date(date - tzoffset).toISOString().slice(0, 10);
  }

  // ì €ì¥í‚¤ ìƒì„±
  function getChecklistKey(date) {
    return `checklist-${formatDateKey(date)}`;
  }
  function getChecklistCheckKey(date, index) {
    return `checklist-${formatDateKey(date)}-item${index}`;
  }
  function getDiaryKey(date) {
    return `diary-${formatDateKey(date)}`;
  }

  const defaultChecklist = ["ìŠ¤ë§ˆíŠ¸í° ì—†ì´ ì•„ì¹¨ ë³´ë‚´ê¸°", "10ë¶„ ëª…ìƒ", "SNS ì•ˆ ë³´ê¸°", "ì‚°ì±… 20ë¶„ ì´ìƒ"];

  // ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ ë¦¬ìŠ¤íŠ¸
  const motivationMessages = [
    "ì˜¤ëŠ˜ë„ ì˜í•˜ê³  ìˆì–´ìš”! í¬ê¸°í•˜ì§€ ë§ê³  ê³„ì† ë‚˜ì•„ê°€ì„¸ìš”! ğŸ’ª",
    "ì‘ì€ ë³€í™”ê°€ í° ì„±ê³µì„ ë§Œë“­ë‹ˆë‹¤. í•œ ê±¸ìŒì”© ê¾¸ì¤€íˆ!",
    "ë„íŒŒë¯¼ ë””í†¡ìŠ¤, ë‹¹ì‹ ì˜ ì§‘ì¤‘ë ¥ì´ ë¹›ë‚˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤!",
    "í˜ë“¤ ë•Œì¼ìˆ˜ë¡ ë” ê°•í•´ì§€ëŠ” ë‹¹ì‹ ì„ ì‘ì›í•©ë‹ˆë‹¤!",
    "ì§‘ì¤‘í•˜ëŠ” ìˆœê°„, ì‚¶ì´ ë” ì„ ëª…í•´ì§‘ë‹ˆë‹¤!",
    "ì˜¤ëŠ˜ì˜ ë…¸ë ¥ì€ ë‚´ì¼ì˜ ì„±ì·¨ë¡œ ëŒì•„ì˜µë‹ˆë‹¤!",
    "ì‰¬ì–´ê°€ëŠ” ê²ƒë„ ìš©ê¸°ì…ë‹ˆë‹¤. ì²œì²œíˆ ê°€ë„ ê´œì°®ì•„ìš”!",
    "ì„±ê³µì€ ê¾¸ì¤€í•¨ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤. ê³„ì† ë‚˜ì•„ê°€ìš”!",
  ];

  // DOM
  const calendarEl = document.getElementById("calendar");
  const monthYearEl = document.getElementById("monthYear");
  const selectedDateStrEl = document.getElementById("selectedDateStr");
  const checklistEl = document.getElementById("checklist");
  const newItemInput = document.getElementById("newItemInput");
  const addItemBtn = document.getElementById("addItemBtn");
  const diaryInput = document.getElementById("diaryInput");
  const saveDiaryBtn = document.getElementById("saveDiaryBtn");
  const toggleWeeklySummaryBtn = document.getElementById("toggleWeeklySummary");
  const weeklySummaryEl = document.getElementById("weeklySummary");
  const motivationMsgEl = document.getElementById("motivationMsg");

  let currentDate = new Date();
  let selectedDate = new Date();

  // ë‹¬ë ¥ ìƒì„±
  function buildCalendar(date) {
    calendarEl.innerHTML = "";
    const year = date.getFullYear();
    const month = date.getMonth();

    monthYearEl.textContent = `${year}ë…„ ${month + 1}ì›”`;

    const firstDay = new Date(year, month, 1).getDay();
    const lastDate = new Date(year, month + 1, 0).getDate();

    // ë¹ˆì¹¸ ì±„ìš°ê¸°
    for(let i=0; i < firstDay; i++){
      calendarEl.appendChild(document.createElement("div"));
    }

    for(let d=1; d <= lastDate; d++){
      const dayDiv = document.createElement("div");
      dayDiv.classList.add("calendar-day");
      dayDiv.textContent = d;

      const today = new Date();
      if(year === today.getFullYear() && month === today.getMonth() && d === today.getDate()){
        dayDiv.classList.add("border","border-blue-500","font-bold");
      }
      if(year === selectedDate.getFullYear() && month === selectedDate.getMonth() && d === selectedDate.getDate()){
        dayDiv.classList.add("selected");
      }

      dayDiv.addEventListener("click", () => {
        selectedDate = new Date(year, month, d);
        renderSelectedDate();
        buildCalendar(currentDate);
        renderChecklistAndDiary();
        setMotivationMessage();
      });

      calendarEl.appendChild(dayDiv);
    }
  }

  // ì„ íƒ ë‚ ì§œ í‘œì‹œ
  function renderSelectedDate(){
    selectedDateStrEl.textContent = selectedDate.toLocaleDateString();
  }

  // ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
  function loadChecklistItems(date){
    const stored = localStorage.getItem(getChecklistKey(date));
    if(stored) return JSON.parse(stored);
    return [...defaultChecklist];
  }

  // ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ & ì²´í¬ ìƒíƒœ ë°˜ì˜
  function renderChecklistAndDiary(){
    checklistEl.innerHTML = "";
    const items = loadChecklistItems(selectedDate);

    if(items.length === 0){
      checklistEl.textContent = "ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ í•­ëª©ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.";
      return;
    }

    items.forEach((item, index) => {
      const id = getChecklistCheckKey(selectedDate, index);
      const checked = localStorage.getItem(id) === "true";

      const label = document.createElement("label");
      label.className = "flex items-center";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.checked = checked; // ì²´í¬ ìƒíƒœ ë°˜ì˜
      checkbox.className = "mr-2";

      checkbox.addEventListener("change", () => {
        localStorage.setItem(id, checkbox.checked);
      });

      const span = document.createElement("span");
      span.textContent = item;

      label.appendChild(checkbox);
      label.appendChild(span);

      checklistEl.appendChild(label);
    });

    // ì†Œê° ë¶ˆëŸ¬ì˜¤ê¸°
    diaryInput.value = localStorage.getItem(getDiaryKey(selectedDate)) || "";
  }

  // ìƒˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ì¶”ê°€
  addItemBtn.addEventListener("click", () => {
    const newItem = newItemInput.value.trim();
    if(newItem === ""){
      alert("ìƒˆ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }
    const items = loadChecklistItems(selectedDate);
    items.push(newItem);
    localStorage.setItem(getChecklistKey(selectedDate), JSON.stringify(items));
    newItemInput.value = "";
    renderChecklistAndDiary();
  });

  // ì†Œê° ì €ì¥
  saveDiaryBtn.addEventListener("click", () => {
    localStorage.setItem(getDiaryKey(selectedDate), diaryInput.value);
    alert("ì†Œê°ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
  });

  // ë‹¬ë ¥ ì›” ì´ë™
  document.getElementById("prevMonth").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() - 1);
    buildCalendar(currentDate);
  });
  document.getElementById("nextMonth").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() + 1);
    buildCalendar(currentDate);
  });

  // ì£¼ê°„ ì†Œê° ìš”ì•½ í† ê¸€
  toggleWeeklySummaryBtn.addEventListener("click", () => {
    if(weeklySummaryEl.style.display === "none" || weeklySummaryEl.style.display === ""){
      buildWeeklySummary();
      weeklySummaryEl.style.display = "block";
      toggleWeeklySummaryBtn.textContent = "ì£¼ê°„ ì†Œê° ìš”ì•½ ë‹«ê¸°";
    } else {
      weeklySummaryEl.style.display = "none";
      toggleWeeklySummaryBtn.textContent = "ì£¼ê°„ ì†Œê° ìš”ì•½ ë³´ê¸°";
    }
  });

  // ì£¼ê°„ ì†Œê° ìš”ì•½ ìƒì„± í•¨ìˆ˜
  function buildWeeklySummary(){
    weeklySummaryEl.innerHTML = "";
    for(let i=6; i >= 0; i--){
      const d = new Date();
      d.setHours(0,0,0,0);
      d.setDate(d.getDate() - i);
      const dateStr = d.toLocaleDateString();

      const diary = localStorage.getItem(getDiaryKey(d)) || "ì‘ì„± ì—†ìŒ";

      const dayDiv = document.createElement("div");
      dayDiv.classList.add("border", "border-gray-300", "p-3", "rounded", "bg-gray-50");

      dayDiv.innerHTML = `
        <strong>${dateStr}</strong><br/>
        ì†Œê°: ${diary.length > 50 ? diary.slice(0,50) + "..." : diary}
      `;

      weeklySummaryEl.appendChild(dayDiv);
    }
  }

  // ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€ ì¶œë ¥ (ë‚ ì§œ ë°”ë€” ë•Œë§ˆë‹¤ ë³€ê²½)
  function setMotivationMessage(){
    const idx = Math.floor(Math.random() * motivationMessages.length);
    motivationMsgEl.textContent = motivationMessages[idx];
  }

  // ì´ˆê¸° ì‹¤í–‰
  buildCalendar(currentDate);
  renderSelectedDate();
  renderChecklistAndDiary();
  setMotivationMessage();

</script>

</body>
</html>






